<Window x:Class="SwitchController.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="设置" Height="520" Width="620"
        WindowStyle="None" AllowsTransparency="True"
        Background="Transparent" WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize">
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <!-- <ResourceDictionary Source="Themes/Theme.Light.xaml"/> -->
            </ResourceDictionary.MergedDictionaries>

            <Style x:Key="BaseButton" TargetType="Button">
                <Setter Property="Foreground" Value="{DynamicResource BrushText}"/>
                <Setter Property="FontWeight" Value="SemiBold"/>
                <Setter Property="Padding" Value="12,8"/>
                <Setter Property="Background" Value="{DynamicResource BrushCard}"/>
                <Setter Property="BorderBrush" Value="{DynamicResource BrushStroke}"/>
                <Setter Property="BorderThickness" Value="1"/>
                <Setter Property="Cursor" Value="Hand"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Grid x:Name="root" RenderTransformOrigin="0.5,0.5">
                                <Grid.RenderTransform>
                                    <TransformGroup>
                                        <ScaleTransform x:Name="scale" ScaleX="1" ScaleY="1"/>
                                        <TranslateTransform x:Name="trans" Y="0"/>
                                    </TransformGroup>
                                </Grid.RenderTransform>
                                <Border x:Name="bd" CornerRadius="12"
                      Background="{TemplateBinding Background}"
                      BorderBrush="{TemplateBinding BorderBrush}"
                      BorderThickness="{TemplateBinding BorderThickness}">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                <Border x:Name="overlay" CornerRadius="12" Background="Black" Opacity="0" IsHitTestVisible="False"/>
                            </Grid>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Trigger.EnterActions>
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <DoubleAnimation Storyboard.TargetName="scale" Storyboard.TargetProperty="ScaleX" To="1.02" Duration="0:0:0.08"/>
                                                <DoubleAnimation Storyboard.TargetName="scale" Storyboard.TargetProperty="ScaleY" To="1.02" Duration="0:0:0.08"/>
                                                <DoubleAnimation Storyboard.TargetName="overlay" Storyboard.TargetProperty="Opacity" To="0.06" Duration="0:0:0.08"/>
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </Trigger.EnterActions>
                                    <Trigger.ExitActions>
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <DoubleAnimation Storyboard.TargetName="scale" Storyboard.TargetProperty="ScaleX" To="1" Duration="0:0:0.10"/>
                                                <DoubleAnimation Storyboard.TargetName="scale" Storyboard.TargetProperty="ScaleY" To="1" Duration="0:0:0.10"/>
                                                <DoubleAnimation Storyboard.TargetName="overlay" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.10"/>
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </Trigger.ExitActions>
                                </Trigger>

                                <Trigger Property="IsPressed" Value="True">
                                    <Trigger.EnterActions>
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <DoubleAnimation Storyboard.TargetName="scale" Storyboard.TargetProperty="ScaleX" To="0.96" Duration="0:0:0.06"/>
                                                <DoubleAnimation Storyboard.TargetName="scale" Storyboard.TargetProperty="ScaleY" To="0.96" Duration="0:0:0.06"/>
                                                <DoubleAnimation Storyboard.TargetName="trans" Storyboard.TargetProperty="Y" To="1.0" Duration="0:0:0.06"/>
                                                <DoubleAnimation Storyboard.TargetName="overlay" Storyboard.TargetProperty="Opacity" To="0.12" Duration="0:0:0.06"/>
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </Trigger.EnterActions>
                                    <Trigger.ExitActions>
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <DoubleAnimation Storyboard.TargetName="scale" Storyboard.TargetProperty="ScaleX" To="1.02" Duration="0:0:0.06"/>
                                                <DoubleAnimation Storyboard.TargetName="scale" Storyboard.TargetProperty="ScaleY" To="1.02" Duration="0:0:0.06"/>
                                                <DoubleAnimation Storyboard.TargetName="trans" Storyboard.TargetProperty="Y" To="0" Duration="0:0:0.06"/>
                                                <DoubleAnimation Storyboard.TargetName="overlay" Storyboard.TargetProperty="Opacity" To="0.06" Duration="0:0:0.06"/>
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </Trigger.ExitActions>
                                </Trigger>

                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter TargetName="root" Property="Opacity" Value="0.45"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style x:Key="TextInput" TargetType="TextBox">
                <Setter Property="Foreground" Value="{DynamicResource BrushText}"/>
                <Setter Property="Background" Value="{DynamicResource BrushCard}"/>
                <Setter Property="BorderBrush" Value="{DynamicResource BrushStroke}"/>
                <Setter Property="BorderThickness" Value="1"/>
                <Setter Property="Padding" Value="10,6"/>
                <Setter Property="FontWeight" Value="SemiBold"/>
                <Setter Property="HorizontalContentAlignment" Value="Center"/>
                <Setter Property="VerticalContentAlignment" Value="Center"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="TextBox">
                            <Border x:Name="bd" CornerRadius="10"
                    Background="{TemplateBinding Background}"
                    BorderBrush="{TemplateBinding BorderBrush}"
                    BorderThickness="{TemplateBinding BorderThickness}">
                                <ScrollViewer x:Name="PART_ContentHost" Margin="0"/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsKeyboardFocused" Value="True">
                                    <Setter TargetName="bd" Property="BorderBrush" Value="{DynamicResource JoyBlue}"/>
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter TargetName="bd" Property="Opacity" Value="0.45"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style x:Key="AccentButtonBlue" TargetType="Button" BasedOn="{StaticResource BaseButton}">
                <Setter Property="BorderBrush" Value="{DynamicResource JoyBlue}"/>
            </Style>
            <Style x:Key="AccentButtonRed" TargetType="Button" BasedOn="{StaticResource BaseButton}">
                <Setter Property="BorderBrush" Value="{DynamicResource JoyRed}"/>
            </Style>

            <Style x:Key="FormLabel" TargetType="TextBlock">
                <Setter Property="Foreground" Value="{DynamicResource BrushSubtle}"/>
                <Setter Property="VerticalAlignment" Value="Center"/>
                <Setter Property="Margin" Value="0,0,8,0"/>
            </Style>
            <Style x:Key="GroupTitle" TargetType="TextBlock">
                <Setter Property="Foreground" Value="{DynamicResource BrushText}"/>
                <Setter Property="FontWeight" Value="Bold"/>
                <Setter Property="FontSize" Value="16"/>
                <Setter Property="Margin" Value="0,0,0,8"/>
            </Style>

            <Style x:Key="CheckOption" TargetType="CheckBox">
                <Setter Property="Foreground" Value="{DynamicResource BrushText}"/>
                <Setter Property="FontWeight" Value="SemiBold"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="CheckBox">
                            <StackPanel Orientation="Horizontal">
                                <Border x:Name="box"
                      Width="18" Height="18" CornerRadius="4"
                      BorderBrush="{DynamicResource BrushStroke}"
                      BorderThickness="1"
                      Background="{DynamicResource BrushCard}"
                      Margin="0,0,6,0">
                                    <Path x:Name="check" Data="M2,6 L6,10 L14,2"
                      Stroke="{DynamicResource JoyBlue}"
                      StrokeThickness="2.2" StrokeEndLineCap="Round" StrokeStartLineCap="Round"
                      Visibility="Collapsed"/>
                                </Border>
                                <ContentPresenter VerticalAlignment="Center"/>
                            </StackPanel>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="box" Property="BorderBrush" Value="{DynamicResource JoyBlue}"/>
                                </Trigger>
                                <Trigger Property="IsChecked" Value="True">
                                    <Setter TargetName="check" Property="Visibility" Value="Visible"/>
                                    <Setter TargetName="box" Property="Background" Value="#102E45"/>
                                    <Setter TargetName="box" Property="BorderBrush" Value="{DynamicResource JoyBlue}"/>
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter TargetName="box" Property="Opacity" Value="0.45"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

        </ResourceDictionary>
    </Window.Resources>


    <Grid>
        <Border CornerRadius="16" Background="Black" Opacity="0.25" Margin="4" IsHitTestVisible="False">
            <Border.Effect>
                <BlurEffect Radius="16"/>
            </Border.Effect>
        </Border>

        <Border CornerRadius="16" Background="{StaticResource BrushPanel}">
            <Grid Margin="16">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <DockPanel Grid.Row="0" LastChildFill="False" Margin="4,0,4,8">
                    <TextBlock Text="设置" FontSize="20" FontWeight="Bold" Foreground="{StaticResource BrushText}" />
                    <Button Content="×" Width="36" Height="28" Margin="8,0,0,0"
                            Style="{StaticResource AccentButtonRed}" Click="Close_Click"
                            DockPanel.Dock="Right"/>
                </DockPanel>

                <Grid Grid.Row="1">
                    <Grid.RowDefinitions>
                        <RowDefinition/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0" Margin="8">
                        <TextBlock Text="网络" Style="{StaticResource GroupTitle}"/>
                        <StackPanel Orientation="Horizontal" Margin="0,4">
                            <TextBlock Text="IP 地址" Width="90" Style="{StaticResource FormLabel}"/>
                            <TextBox x:Name="tbIp" Width="180" Style="{StaticResource TextInput}" ToolTip="例如 192.168.0.123"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,6">
                            <TextBlock Text="端口" Width="90" Style="{StaticResource FormLabel}"/>
                            <TextBox x:Name="tbPort" Width="120" Style="{StaticResource TextInput}" ToolTip="例如 6000"/>
                        </StackPanel>

                        <Separator Margin="0,10,0,10" Background="{StaticResource BrushStroke}" Height="1"/>

                        <TextBlock Text="画面" Style="{StaticResource GroupTitle}"/>
                        <StackPanel Orientation="Horizontal" Margin="0,4">
                            <TextBlock Text="模式" Width="90" Style="{StaticResource FormLabel}"/>
                            <ComboBox x:Name="cbStreamMode" Width="180">
                                <ComboBoxItem Content="持续拉流"/>
                                <ComboBoxItem Content="操作预览"/>
                                <ComboBoxItem Content="关闭预览"/>
                            </ComboBox>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,6">
                            <TextBlock Text="FPS" Width="90" Style="{StaticResource FormLabel}"/>
                            <TextBox x:Name="tbFps" Width="120" Style="{StaticResource TextInput}" ToolTip="建议 15~30"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,6">
                            <TextBlock Text="预览时长(s)" Width="90" Style="{StaticResource FormLabel}"/>
                            <TextBox x:Name="tbPreviewSecs" Width="120" Style="{StaticResource TextInput}" ToolTip="预览模式下有效"/>
                        </StackPanel>
                    </StackPanel>

                    <StackPanel Grid.Column="1" Margin="8">
                        <TextBlock Text="手感" Style="{StaticResource GroupTitle}"/>
                        <StackPanel Orientation="Horizontal" Margin="0,4">
                            <TextBlock Text="死区(px)" Width="90" Style="{StaticResource FormLabel}"/>
                            <TextBox x:Name="tbDeadZone" Width="120" Style="{StaticResource TextInput}" ToolTip="如 8"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,6">
                            <TextBlock Text="节流(ms)" Width="90" Style="{StaticResource FormLabel}"/>
                            <TextBox x:Name="tbSendInterval" Width="120" Style="{StaticResource TextInput}" ToolTip="如 15~25"/>
                        </StackPanel>

                        <Separator Margin="0,10,0,10" Background="{StaticResource BrushStroke}" Height="1"/>

                        <TextBlock Text="其他" Style="{StaticResource GroupTitle}"/>
                        <CheckBox x:Name="chkAutoConnect" Style="{StaticResource CheckOption}" Content="启动后自动连接" Foreground="{StaticResource BrushText}" />
                        <StackPanel Orientation="Horizontal" Margin="0,6">
                            <TextBlock Text="主题" Width="30" Style="{StaticResource FormLabel}"/>
                            <ComboBox x:Name="cbTheme" Width="180">
                                <ComboBoxItem Content="深色 (Dark)"  Tag="Dark"/>
                                <ComboBoxItem Content="浅色 (Light)" Tag="Light"/>
                                <ComboBoxItem Content="传说Z-A (限定)" Tag="ZA"/>
                            </ComboBox>
                        </StackPanel>
                    </StackPanel>
                </Grid>

                <DockPanel Grid.Row="2" Margin="0,10,0,0">
                    <StackPanel Orientation="Horizontal" DockPanel.Dock="Right" >
                        <Button Content="恢复默认" Style="{StaticResource BaseButton}" Margin="0,0,8,0" Height="36" Width="60" Click="Reset_Click"/>
                        <Button Content="取消" Style="{StaticResource BaseButton}" Margin="0,0,8,0" Height="36" Width="50" Click="Cancel_Click"/>
                        <Button Content="确定" Style="{StaticResource AccentButtonBlue}" 
                                        Height="36" Width="50" Click="Ok_Click"/>
                    </StackPanel>
                </DockPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
